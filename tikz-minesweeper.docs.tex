\documentclass{article}

\usepackage{ctex}
\usepackage{geometry}
\usepackage{verbatim}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage{colortbl}
\usepackage{subfig}
\usepackage{float}
\usepackage{multicol}
\usepackage{tikz-minesweeper}

\usepackage[pdfborder=001]{hyperref}

\geometry{scale=.8}

\title{\texttt{tikz-minesweeper}宏包使用手册}
\author{濮天羿\footnote{本项目的维护者} \quad 向飞宇\footnote{本项目的创建者}}
\date{\today}

\begin{document}
    \maketitle

    \tableofcontents

    \clearpage

    \section{绘制示例}

    \begin{multicols}{2}
    \begin{verbatim}
    \usepackage{tikz-minesweeper}
    \begin{document}
        \begin{tikzpicture}
            \board{3}{5}
            \row{0}{f,20,1,2,3}
            \row{1}{A, ,4,0,5}
            \row{2}{m, ,6,7,8}
        \end{tikzpicture}
    \end{document}
    \end{verbatim}
    \columnbreak
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \board{3}{5}
                \row{0}{f,20,1,2,3}
                \row{1}{A, ,4,0,5}
                \row{2}{m, ,6,7,8}
        \end{tikzpicture}
        \caption*{示例: 在3x5区域内绘制数字、雷、旗帜、空格和标记}
    \end{figure}
    \end{multicols}

    \section{绘制指令介绍}

    \subsection{配色}
    \texttt{tikz-minesweeper}宏包定义了用于绘制扫雷数字和盘面的配色.

    \begin{table}[H]
        \centering
        \begin{tabular}{ccccc}
            \toprule
            颜色 & R & G & B & 场景  \\
            \midrule
            \textcolor{color0}{color0} & 192 & 192 & 192 & 格子内部 / 外边框 \\
            \textcolor{color1}{color1} & 0 & 0 & 255 & 数字1 \\
            \textcolor{color2}{color2} & 0 & 128 & 0 & 数字2 \\
            \textcolor{color3}{color3} & 255 & 0 & 0 & 数字3 \\
            \textcolor{color4}{color4} & 0 & 0 & 128 & 数字4 \\
            \textcolor{color5}{color5} & 128 & 0 & 0 & 数字5 \\
            \textcolor{color6}{color6} & 0 & 128 & 128 & 数字6 \\
            \textcolor{color7}{color7} & 0 & 0 & 0 & 数字7 \\
            \textcolor{color8}{color8} & 128 & 128 & 128 & 数字8 / 格子阴影 / 按下的格子边界 \\
            \textcolor{cborder}{cborder} & 160 & 160 & 160 & 边框阴影 \\
            \cellcolor{black}\textcolor{clight}{clight} & 255 & 255 & 255 & 高亮 \\
            \bottomrule
        \end{tabular}
        \caption*{颜色对照表}
    \end{table}

    \subsection{方格元素}
    为了与标准扫雷游戏一致, 本宏包中一格的边长是\textbf{16pt}.
    \begin{itemize}
        \item[\texttt{\textbackslash flag}] 绘制旗子
        \begin{figure}[!htp]
            \centering
            \begin{tikzpicture}
                \begin{scope}[scale=10]
                    \flag
                    \draw[gray] (0,0) rectangle (16pt, -16pt);

                    \draw[dashed] (0,-4pt) node[left] {-4} -- (8.5pt,-4pt);
                    \draw[dashed,red] (16pt,-4.5pt) node[right] {-4.5} -- (8.5pt,-4.5pt);
                    \draw[dashed,red] (0,-6.5pt) node[left] {-6.5} -- (4pt,-6.5pt);
                    \draw[dashed,red] (16pt,-8.5pt) node[right] {-8.5} -- (8.5pt,-8.5pt);
                    \draw[dashed] (0,-11pt) node[left] {-11} -- (6.5pt,-11pt);
                    \draw[dashed] (16pt,-12pt) node[right] {-12} -- (12pt,-12pt);
                    \draw[dashed] (0,-13pt) node[left] {-13} -- (5pt,-13pt);

                    \draw[dashed,red] (4pt,0) node[above] {4} -- (4pt,-6.5pt);
                    \draw[dashed] (5pt,-16pt) node[below] {5} -- (5pt,-13pt);
                    \draw[dashed] (6.5pt,0) node[above] {6.5} -- (6.5pt,-11pt);
                    \draw[dashed] (8.5pt,-16pt) node[below] {8.5} -- (8.5pt,-13pt);
                    \draw[dashed] (9.5pt,0) node[above] {9.5} -- (9.5pt,-4pt);
                    \draw[dashed] (10.5pt,-16pt) node[below] {10.5} -- (10.5pt,-13pt);
                    \draw[dashed] (12pt,0) node[above] {12} -- (12pt,-12pt);
                \end{scope}
            \end{tikzpicture}
            \caption*{旗子参数. 方框是一格参考线, 左上角为原点. }
        \end{figure}
        \item[\texttt{\textbackslash mine}] 绘制雷
        \begin{figure}[!htp]
            \centering
            \begin{tikzpicture}
                \begin{scope}[scale=10]
                    \mine
                \end{scope}
            \end{tikzpicture}
        \end{figure}
        \item[\texttt{\textbackslash cellup}] 绘制弹起的方块, 左上角原点. 四周形成立体感的宽度为2pt.


        \item[\texttt{\textbackslash celldown}] 绘制按下的方块, 左上角原点. 左和上的边界宽度为1pt.
        \begin{figure}[!htp]
            \captionsetup[subfloat]{labelformat=empty}
            \centering
            \subfloat[弹起的方块]{\begin{tikzpicture}\begin{scope}[scale=5]\cellup\end{scope}\end{tikzpicture}}
            \quad
            \subfloat[按下的方块]{\begin{tikzpicture}\begin{scope}[scale=5]\celldown\end{scope}\end{tikzpicture}}
        \end{figure}
        \item[\texttt{\textbackslash cellnum\{数字\}}] 在当前方块中填入带配色的数字\raisebox{-0.5ex}{\tikz{\fillcellnum{0}}\tikz{\fillcellnum{1}}\tikz{\fillcellnum{2}}\tikz{\fillcellnum{3}}\tikz{\fillcellnum{4}}\tikz{\fillcellnum{5}}\tikz{\fillcellnum{6}}\tikz{\fillcellnum{7}}\tikz{\fillcellnum{8}}}. 数字中心为(8.5pt,8.5pt)

    \end{itemize}

    \subsection{边框元素}
    边框分为三层, 中间层是color0, 宽度是6pt, 内外层用clight/cborder提供立体感, 宽度3pt. 提供立体感的方式和\texttt{\textbackslash cellup}同理. 左边和上边的高亮外边缘用cborder封边.
    \begin{itemize}
        \item[\texttt{\textbackslash tlborder}] 绘制左上角边框, 右下角是原点.
        \item[\texttt{\textbackslash trborder}] 绘制右上角边框, 左下角是原点.
        \item[\texttt{\textbackslash blborder}] 绘制左下角边框, 右上角是原点.
        \item[\texttt{\textbackslash brborder}] 绘制右下角边框, 左上角是原点.
        \item[\texttt{\textbackslash tborder\{长度\}}] 绘制上边框, 左下角是原点.
        \item[\texttt{\textbackslash bborder\{长度\}}] 绘制下边框, 左上角是原点.
        \item[\texttt{\textbackslash lborder\{长度\}}] 绘制左边框, 右上角是原点.
        \item[\texttt{\textbackslash rborder\{长度\}}] 绘制右边框, 左上角是原点.
        \begin{figure}[!htp]
            \centering
            \begin{tikzpicture}
                \begin{scope}[scale=4]
                    \board{1}{1}
                    \draw[dashed] (-14pt,0) -- (30pt,0);
                    \draw[dashed] (-14pt,-16pt) -- (30pt,-16pt);
                    \draw[dashed] (0,14pt) -- (0,-30pt);
                    \draw[dashed] (16pt,14pt) -- (16pt,-30pt);
                \end{scope}
            \end{tikzpicture}
            \caption*{边框组装效果}
        \end{figure}
    \end{itemize}

    \subsection{模块}
    \begin{itemize}
        \item[\texttt{\textbackslash cell\{行\}\{列\}\{内容\}}] 在第[行]行第[列]列交叉处绘制包含[内容]的方格, 行列从0开始编号. 如果内容是0-8的数字, 方格是按下状态并且数字会上色. 如果内容是f, 方格是弹起状态并且会插旗. 如果内容是其他单个字符, 方格是弹起状态并包含该字符. 方格弹起状态时的字符中心是(8pt,-8pt). 内容不能为空, 如果希望没有内容, 可以把空格作为内容传进去.
        \item[\texttt{\textbackslash row\{行\}\{内容\}}] 在第[行]行从左到右绘制多个方格. 内容的格式是用逗号隔开单个字符, 每个字符作为\texttt{\textbackslash cell}的第三个参数. 如果字符长度超过\texttt{8pt}, 将会自动缩小字符, 转化为\texttt{\tiny}模式.
        \item[\texttt{\textbackslash board\{行\}\{列\}}] 绘制[行]行[列]列的边框.
        \begin{figure}[!htp]
            \centering
            \begin{tabular}{|c|}
                \hline
                123
                \\\hline
            \end{tabular}
            \quad
            \begin{tabular}{c}
                \begin{tikzpicture}
                    \board{3}{5}
                    \row{0}{f,20,1,2,3}
                    \row{1}{A, ,4,0,5}
                    \row{2}{m, ,6,7,8}
                \end{tikzpicture}
            \end{tabular}
            \caption*{使用\texttt{\textbackslash board}和\texttt{\textbackslash row}摆雷}
        \end{figure}
        \item[\texttt{\textbackslash tboard\{行\}\{列\}}] 绘制[行]行[列]列的边框, 但是不包含下边.
        \item[\texttt{\textbackslash lboard\{行\}\{列\}}] 绘制[行]行[列]列的边框, 但是不包含右边.
        \item[\texttt{\textbackslash tlboard\{行\}\{列\}}] 绘制[行]行[列]列的边框, 但是不包含下边和右边.
        \begin{figure}[!htp]
            \captionsetup[subfloat]{labelformat=empty}
            \centering
            \subfloat[\texttt{\textbackslash tboard}]{\begin{tikzpicture}\begin{scope}[scale=3]\tboard{1}{1}\end{scope}\end{tikzpicture}}
            \quad
            \subfloat[\texttt{\textbackslash lboard}]{\begin{tikzpicture}\begin{scope}[scale=3]\lboard{1}{1}\end{scope}\end{tikzpicture}}
            \quad
            \subfloat[\texttt{\textbackslash tlboard}]{\begin{tikzpicture}\begin{scope}[scale=3]\tlboard{1}{1}\end{scope}\end{tikzpicture}}
        \end{figure}
    \end{itemize}

\end{document}
