\documentclass{article}

\usepackage{ctex}
\usepackage{verbatim}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage{colortbl}
\usepackage{subfig}
\usepackage{float}
\usepackage{multicol}
\usepackage{tikz-minesweeper}

\usepackage[pdfborder=001]{hyperref}

\title{\texttt{tikz-minesweeper}宏包使用手册}
\author{濮天羿\footnote{本项目的维护者} \quad 向飞宇\footnote{本项目的创建者}}
\date{\today}

\begin{document}
\maketitle

\tableofcontents

\clearpage

\section{绘制示例}

\begin{multicols}{2}
    \begin{verbatim}
\usepackage{tikz-minesweeper}
\begin{document}
    \begin{tikzpicture}
        \board{5}{5}
        \row{0}{f{20}12}
        \row{1}{A-40}
        \row{2}{m-67}
        \row{3}{rgbc}
        \row{4}{oltv}
        \col{4}{358y-}
    \end{tikzpicture}
\end{document}
    \end{verbatim}
    \columnbreak
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \board{5}{5}
            \row{0}{f{20}12}
            \row{1}{A-40}
            \row{2}{m-67}
            \row{3}{rgbc}
            \row{4}{oltv}
            \col{4}{358y-}
        \end{tikzpicture}
        \caption*{示例: 在5x5区域内绘制数字、雷、旗帜、空格和标记}
    \end{figure}
\end{multicols}

\section{绘制指令介绍}

\subsection{配色}
\texttt{tikz-minesweeper}宏包定义了用于绘制扫雷数字和盘面的配色.

\begin{table}[H]
    \centering
    \begin{tabular}{ccccc}
        \toprule
        颜色                                        & R   & G   & B   & 场景                              \\
        \midrule
        \textcolor{color0}{color0}                  & 192 & 192 & 192 & 格子内部 / 外边框                 \\
        \textcolor{color1}{color1}                  & 0   & 0   & 255 & 数字1                             \\
        \textcolor{color2}{color2}                  & 0   & 128 & 0   & 数字2                             \\
        \textcolor{color3}{color3}                  & 255 & 0   & 0   & 数字3                             \\
        \textcolor{color4}{color4}                  & 0   & 0   & 128 & 数字4                             \\
        \textcolor{color5}{color5}                  & 128 & 0   & 0   & 数字5                             \\
        \textcolor{color6}{color6}                  & 0   & 128 & 128 & 数字6                             \\
        \textcolor{color7}{color7}                  & 0   & 0   & 0   & 数字7                             \\
        \textcolor{color8}{color8}                  & 128 & 128 & 128 & 数字8 / 格子阴影 / 按下的格子边界 \\
        \textcolor{cborder}{cborder}                & 160 & 160 & 160 & 边框阴影                          \\
        \cellcolor{black}\textcolor{clight}{clight} & 255 & 255 & 255 & 高亮                              \\
        \bottomrule
    \end{tabular}
    \caption*{颜色对照表}
\end{table}

\subsection{方格元素}
本宏包中设定单位长度为\textbf{1pt}, 下文如无特殊说明, 所有数据的单位为\textbf{pt}, 且所有数据不带单位. 如果需要放大一张地图, 请使用\texttt{scope}环境中的\texttt{scale}参数.

为了与标准扫雷游戏一致, 一格的边长是\textbf{16}.
\begin{itemize}
    \item[\texttt{\textbackslash flag}] 绘制旗子
        \begin{figure}[!htp]
            \centering
            \begin{tikzpicture}
                \begin{scope}[scale=10]
                    \flag
                    \draw[gray] (0,0) rectangle (16, -16);

                    \draw[dashed] (0,-4) node[left] {-4} -- (8.5,-4);
                    \draw[dashed,red] (16,-4.5) node[right] {-4.5} -- (8.5,-4.5);
                    \draw[dashed,red] (0,-6.5) node[left] {-6.5} -- (4,-6.5);
                    \draw[dashed,red] (16,-8.5) node[right] {-8.5} -- (8.5,-8.5);
                    \draw[dashed] (0,-11) node[left] {-11} -- (6.5,-11);
                    \draw[dashed] (16,-12) node[right] {-12} -- (12,-12);
                    \draw[dashed] (0,-13) node[left] {-13} -- (5,-13);

                    \draw[dashed,red] (4,0) node[above] {4} -- (4,-6.5);
                    \draw[dashed] (5,-16) node[below] {5} -- (5,-13);
                    \draw[dashed] (6.5,0) node[above] {6.5} -- (6.5,-11);
                    \draw[dashed] (8.5,-16) node[below] {8.5} -- (8.5,-13);
                    \draw[dashed] (9.5,0) node[above] {9.5} -- (9.5,-4);
                    \draw[dashed] (10.5,-16) node[below] {10.5} -- (10.5,-13);
                    \draw[dashed] (12,0) node[above] {12} -- (12,-12);
                \end{scope}
            \end{tikzpicture}
            \caption*{旗子参数. 方框是一格参考线, 左上角为原点. }
        \end{figure}
    \item[\texttt{\textbackslash mine}] 绘制雷
        \begin{figure}[!htp]
            \centering
            \begin{tikzpicture}
                \begin{scope}[scale=10]
                    \mine
                \end{scope}
            \end{tikzpicture}
        \end{figure}
    \item[\texttt{\textbackslash cellup}] 绘制弹起的方块, 左上角原点. 四周形成立体感的宽度为2.


    \item[\texttt{\textbackslash celldown}] 绘制按下的方块, 左上角原点. 左和上的边界宽度为1.
        \begin{figure}[!htp]
            \captionsetup[subfloat]{labelformat=empty}
            \centering
            \subfloat[弹起的方块]{\begin{tikzpicture}\begin{scope}[scale=5]\cellup\end{scope}\end{tikzpicture}}
            \quad
            \subfloat[按下的方块]{\begin{tikzpicture}\begin{scope}[scale=5]\celldown\end{scope}\end{tikzpicture}}
        \end{figure}
    \item[\texttt{\textbackslash cellnum\{数字\}}] 在当前方块中填入带配色的数字\raisebox{-0.5ex}{\tikz{\cellnum{0}}\tikz{\cellnum{1}}\tikz{\cellnum{2}}\tikz{\cellnum{3}}\tikz{\cellnum{4}}\tikz{\cellnum{5}}\tikz{\cellnum{6}}\tikz{\cellnum{7}}\tikz{\cellnum{8}}}. 数字中心为(8.5,8.5).

\end{itemize}

\subsection{边框元素}
边框分为三层, 中间层是color0, 宽度是6, 内外层用clight/cborder提供立体感, 宽度3. 提供立体感的方式和 \texttt{\textbackslash cellup} 同理. 左边和上边的高亮外边缘用cborder封边.
\begin{itemize}
    \item[\texttt{\textbackslash border[tlbr]}] 绘制以格为单位长度(宽度)的边框. t, r, b, l 分别代表上, 右, 下, 左边框, 如果相邻边框同时绘制, 将自动绘制对应的角.
        \begin{figure}[!htp]
            \centering
            \begin{tikzpicture}
                \begin{scope}[scale=4]
                    \border
                    \draw[dashed] (-14,0) -- (30,0);
                    \draw[dashed] (-14,-16) -- (30,-16);
                    \draw[dashed] (0,14) -- (0,-30);
                    \draw[dashed] (16,14) -- (16,-30);
                    \node at (8, 6) {t};
                    \node at (22, -8) {r};
                    \node at (8, -22) {b};
                    \node at (-6, -8) {l};
                \end{scope}
            \end{tikzpicture}
            \caption*{边框组装效果}
        \end{figure}
\end{itemize}

\subsection{模块}
\begin{itemize}
    \item[\texttt{\textbackslash cell\{行\}\{列\}\{内容\}}] 在第[行]行第[列]列交叉处绘制包含[内容]的方格, 行列从0开始编号. 如果内容是0-8的数字, 方格是按下状态并且数字会上色. 如果内容是f, 方格是弹起状态并且会插旗. 如果内容是其他单个字符, 方格是弹起状态并包含该字符. 方格弹起状态时的字符中心是(8,-8). 内容不能为空, 如果内容是-, 方格是按下状态并且无字符, 如果内容中含有多个字符, 将会自动缩小字符, 转化为 \texttt{\textbackslash tiny} 模式. 如果内容是r, g, b, c, y, o, l, t, v, 将给该方格染成对应颜色.
    \item[\texttt{\textbackslash row\{行\}\{内容\}}] 在第[行]行从左到右绘制多个方格. 内容的格式按照顺序输入字符, 每个字符作为 \texttt{\textbackslash cell} 的第三个参数. 如果希望输入多个字符, 需要使用大括号, 例如\texttt{1\{23\}4}代表1, 23和4这这三个字符.
    \item[\texttt{\textbackslash col\{列\}\{内容\}}] 在第[列]列从左到右绘制多个方格, 语法与 \texttt{\textbackslash row} 一致.
    \item[\texttt{\textbackslash board[tlbr]\{行\}\{列\}}] 绘制[行]行[列]列的边框, t, r, b, l 为与 \texttt{\textbackslash border} 对应\footnote{注: \texttt{\textbackslash board[tlbr]\{1\}\{1\}}与\texttt{\textbackslash border[tlbr]}等价.}的可叠加的边框开关, 默认全部开启, 即地图中有完整边框. 此选项可以根据自己需求进行定制.
        \begin{figure}[!htp]
            \captionsetup[subfloat]{labelformat=empty}
            \centering
            \subfloat[\texttt{\textbackslash board}]{\begin{tikzpicture}[scale=2]\board{1}{1}\end{tikzpicture}}
            \quad
            \subfloat[\texttt{\textbackslash board[tlb]} 或 \\ \texttt{\textbackslash board[-r]} ]{\begin{tikzpicture}[scale=2]\border[-r]\end{tikzpicture}}
            \quad
            \subfloat[\texttt{\textbackslash board[tlr]} 或 \\ \texttt{\textbackslash board[-b]} ]{\begin{tikzpicture}[scale=2]\border[-b]\end{tikzpicture}}
            \quad
            \subfloat[\texttt{\textbackslash board[tl]}]{\begin{tikzpicture}[scale=2]\border[tl]\end{tikzpicture}}
        \end{figure}
    \item[\texttt{\textbackslash colorcell\{颜色\}\{位置\}}] 将[位置]位置的方格染色为[颜色]颜色.
        \begin{multicols}{2}
            \begin{verbatim}
\begin{tikzpicture}
    \board{3}{5}
    \row{0}{f{20}123}
    \row{1}{A-405}
    \row{2}{m-678}
    \colorcell{green}{
        (0,0:1), (0:1,3)
    }
    \colorcell{red}{
        (0,4), (1:2,0:2)
    }
\end{tikzpicture}
            \end{verbatim}
            \columnbreak
            \begin{figure}[H]
                \centering
                \begin{tikzpicture}
                    \board{3}{5}
                    \row{0}{f{20}123}
                    \row{1}{A-405}
                    \row{2}{m-678}
                    \colorcell{green}{
                        (0,0:1), (0:1,3)
                    }
                    \colorcell{red}{
                        (0,4), (1:2,0:2)
                    }
                \end{tikzpicture}
                \caption*{方格染色}
            \end{figure}
        \end{multicols}
\end{itemize}

\end{document}
